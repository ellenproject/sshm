<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSHM-West Asia</title>
    <!-- bootstrap icon -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <!-- style css -->
    <link rel="stylesheet" href="./css/stylenew.css">
</head>
<body>
    
    <div class="container">
        <div class="wrap">
            <div class="intro">
                <h2 class="typing"></h2>
                <div class="contain">
                    <div class="ship"><img src="./img/ship-01.png" alt=""></div>
                    <div class="person person-01"><img src="./img/char-01.png" alt=""></div>
                </div>
            </div>
            <div class="next">
                <a href="#popup3" class="button" data-item="3"><h2>請幫忙搬運貨品</h2></a>
            </div>
            <audio src="./audio/【2遊戲進行配樂】China and Japan.wav" class="game-audio"></audio>
        </div>
        <svg id="圖層_1" data-name="圖層 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1862.77 1017.34"><defs><style>.cls-1,.cls-2{fill:none;stroke:#fff;stroke-miterlimit:10;}.cls-1{stroke-width:2.03px;}.cls-2{stroke-width:2px;}</style></defs><rect class="cls-1" x="13.39" y="11.56" width="1836" height="994.21"/><path class="cls-2" d="M1856.77,1047.72c0-.6,0-1.2,0-1.81a34.15,34.15,0,0,1,34.14-34.15h0V66.53h0a34.15,34.15,0,0,1-34.14-34.15H64.24A34.15,34.15,0,0,1,30.1,66.53v945.23a34.15,34.15,0,0,1,34.14,34.15c0,.61,0,1.21,0,1.81Z" transform="translate(-29.1 -31.38)"/></svg>
    </div>
    <!-- 遊戲 -->
    <div id="popup3" class="overlay show--3">
        <div class="popup popup--3">
            <div class="body body--3">
                <div class="wrap fl">
                    <div class="emotion"></div>
                    <div class="choice">
                        <div class="changeInfo"><h2></h2></div>
                        <ul class="list">
                            <li>
                                <i class="arrow bi bi-caret-down-fill"></i>
                                <div class="op op--1" data-num="1"></div>
                            </li>
                            <li>
                                <i class="arrow bi bi-caret-down-fill"></i>
                                <div class="op op--2" data-num="2"></div>
                            </li>
                            <li>
                                <i class="arrow bi bi-caret-down-fill"></i>
                                <div class="op op--3" data-num="3"></div>
                            </li>
                            <li>
                                <i class="arrow bi bi-caret-down-fill"></i>
                                <div class="op op--4" data-num="4"></div>
                            </li>
                        </ul>
                        <div class="contain">
                            <div class="ware vanish"><img src="./img/ship-s.png" alt=""></div>
                            <div class="ware moving"><img src="./img/ship-01.png" alt=""></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 過場動畫 -->
    <div id="popup4" class="overlay show--4">
        <div class="popup popup--4">
            <div class="body body--4">
                <div class="fullscreen">
                    <video id="myVideo" class="myVideo" playsinline muted autoplay width="640" height="360" style="width: 100%; height: 100%;" >
                        <source src="./video/end.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
        </div>
    </div>
    <!-- 結束頁 -->
    <div id="popup5" class="overlay show--5">
        <div class="popup popup--5">
            <div class="body body--5">
                <div class="success">
                    <div class="subtitle">恭喜，挑戰成功！</div>
                    <div class="des">你真厲害！成為古代大貿易家，讓這些特色物品流通於各地。<br/>歡迎點擊按鈕分享展覽資訊，一起認識臺灣古代海陸交流！</div>
                </div>
                <div class="wrap">
                    <div class="item">
                        <div class="left">
                            <div class="person"><img src="./img/char-01.png" alt=""></div>
                            <div class="ware"><img src="./img/ware-01.png" alt=""></div>
                        </div>
                        <div class="right">
                            <div class="mobile-b"><img src="./img/ship-01.png" alt=""></div>
                        </div>
                    </div>
                    <div class="buttons">
                        <a href="./index.html" class="again"><img src="./img/button-again.png" alt=""><h4>再試一次</h4></a>
                        <a href="./ryukyu.html" class="next"><img src="./img/button-next.png" alt=""><h4>下個挑戰</h4></a>
                        <a href="#" class="qrcode"><img src="./img/button-qrcode.png" alt=""><h4>拍照濾鏡</h4></a>
                    </div>
                    <div class="item">
                        <div class="mobile-n"><img src="./img/ship-01.png" alt=""></div>
                    </div>
                </div>
                <div class="logos">
                    <div class="logo host">
                        <h5>主辦單位</h5>
                        <div class="Img"><img src="./img/logo-01.png" alt=""></div>
                    </div>
                    <div class="logo undertake">
                        <h5>承辦單位</h5>
                        <div class="Img"><img src="./img/logo-02.png" alt=""></div>
                        <div class="Img"><img src="./img/logo-03.png" alt=""></div>
                    </div>
                    <div class="logo coorgan">
                        <h5>協辦單位</h5>
                        <div class="Img"><img src="./img/logo-04.png" alt=""></div>
                        <div class="Img"><img src="./img/logo-05.png" alt=""></div>
                        <div class="Img"><img src="./img/logo-06.png" alt=""></div>
                    </div>
                </div>
            </div>
            <svg id="圖層_1" data-name="圖層 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1862.77 1017.34"><defs><style>.cls-1,.cls-2{fill:none;stroke:#fff;stroke-miterlimit:10;}.cls-1{stroke-width:2.03px;}.cls-2{stroke-width:2px;}</style></defs><rect class="cls-1" x="13.39" y="11.56" width="1836" height="994.21"/><path class="cls-2" d="M1856.77,1047.72c0-.6,0-1.2,0-1.81a34.15,34.15,0,0,1,34.14-34.15h0V66.53h0a34.15,34.15,0,0,1-34.14-34.15H64.24A34.15,34.15,0,0,1,30.1,66.53v945.23a34.15,34.15,0,0,1,34.14,34.15c0,.61,0,1.21,0,1.81Z" transform="translate(-29.1 -31.38)"/></svg>
        </div>
    </div>
    <!-- 答對 -->
    <div id="popup6" class="overlay--6 show--6">
        <div class="popup popup--6">
            <div class="body body--6">
                <!-- <h1>答對囉！</h1> -->
            </div>
        </div>
        <audio src="./audio/【答對音效】Correct__Starlitetw_Audios_correct.m4a" class="right-audio"></audio>
    </div>
    <!-- 答錯 -->
    <div id="popup7" class="overlay--7 show--7">
        <div class="popup popup--7">
            <div class="body body--7">
                <!-- <h1>答錯囉！</h1> -->
            </div>
        </div>
        <audio src="./audio/【答錯音效】wrong-answer-trombone-01.mp3" class="wrong-audio"></audio>
    </div>
    <section class="mute-video">
        <div class="play">
            <img class="svg" src="./img/play.svg" alt="">
        </div>
        <div class="pause active">
            <img class="svg" src="./img/pause.svg" alt="">
        </div>
    </section>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script>
        $(document).ready(function(){
            

            //打字效果
            const str = "我是西亞船主，我們的船預計從阿拉伯半島地區，歷經數個月到東南亞及中國進行貿易。";

            const spans = '<span>'+str.split('').join('</span><span>')+'</span>';
            $(spans).hide().appendTo('.typing').each(function(i){
                $(this).delay(150*i).css({
                    display: 'inline',
                    opacity: 0,
                }).animate({
                    opacity: 1,
                }, 100);
            })
            

            //popup
            $('.button').on('click', function(e){
                event.preventDefault();
                let item = $(this).data("item");
                $(`.show--${item}`).addClass('visible').siblings().removeClass('visible');
            });
            $('.overlay').on('click', function(e){
                // event.preventDefault();
                if($(event.target).is('.close') || $(event.target).is('.overlay')){
                    // event.preventDefault();
                    $(this).removeClass('visible');
                }
            })

            const muteVideo = document.querySelector(".mute-video")            
            const gameAudio = document.querySelector(".game-audio")
            const rightAudio = document.querySelector(".right-audio")
            const wrongAudio = document.querySelector(".wrong-audio")
            const list = document.querySelector(".list")
            const vid = document.querySelector(".myVideo")
            // vid.pause();
            
            muteVideo.addEventListener('click', function(e){
                if($("video").prop("muted")){
                    $("video").prop("muted", false);
                    // $(".play").addClass("active");
                    // $(".pause").removeClass("active");

                    // $("audio").prop("muted", false);
                    
                    if($("audio").prop("muted")){
                        $("audio").prop("muted", false)
                        $(".play").addClass("active");
                        $(".pause").removeClass("active");

                        $(".myVideo").prop("muted", true);
                        $(".myVideo").muted = true;
                        if($(".game-audio").get(0).muted == false){
                            gameAudio.play();
                        }else{
                            gameAudio.pause();
                        }
                        
                        $(".button").on('click', function(e){
                            if($(".show--3").hasClass("visible")){
                                list.addEventListener('click', function(e){
                                    for(i=0; i<li.length; i++){
                                        if(e.target.getAttribute("data-num") == "1"){
                                            wrongAudio.play();
                                            wrongAudio.currentTime = 0;
                                        }else if(e.target.getAttribute("data-num") == "2"){
                                            rightAudio.play();
                                            rightAudio.currentTime = 0;
                                            if(op4.classList.contains('op--4selected')){
                                                setTimeout(() => {
                                                    gameAudio.remove();
                                                    gameAudio.pause();
                                                    vid.play();
                                                    vid.muted = false;
                                                    vid.currentTime = 0;
                                                    $(".myVideo").prop("muted", false);
                                                }, 4000);
                                            }
                                        }else if(e.target.getAttribute("data-num") == "3"){
                                            wrongAudio.play();
                                            wrongAudio.currentTime = 0;
                                        }else if(e.target.getAttribute("data-num") == "4"){
                                            rightAudio.play();
                                            rightAudio.currentTime = 0;
                                            if(op2.classList.contains('op--2selected')){
                                                setTimeout(() => {
                                                    gameAudio.remove();
                                                    gameAudio.pause();
                                                    vid.play();
                                                    vid.muted = false;
                                                    vid.currentTime = 0;
                                                    $(".myVideo").prop("muted", false);
                                                }, 4000);
                                            }
                                        }
                                    }
                                })
                            }
                        })
                    }else{
                        $("audio").prop("muted", true)
                        $("video").prop("muted", true)
                        $(".pause").addClass("active");
                        $(".play").removeClass("active");
                    }
                }else{
                    //卡在最後動畫：
                    //如果有聲變無聲，就沒辦法再回到有聲
                    //如果關閉變開啟，就沒辦法再回到關閉
                    $("video").prop("muted", true);
                    // $(".pause").addClass("active");
                    // $(".play").removeClass("active");
                    $(".myVideo").muted = true;

                    // $("audio").prop("muted", true);
                }
            })

            // muteVideo.addEventListener('click', function(e){
            //     if($("video").prop("muted")){
            //         $("video").prop("muted", false);
            //         $(".play").addClass("active");
            //         $(".pause").removeClass("active");

            //         $("audio").prop("muted", false);

                    
            //         //全靜音ok
            //         //全聲音ok
            //         //無法開關聲音
            //         if($(".game-audio").get(0).muted == false){
            //             $(".myVideo").prop("muted", true);
            //             $(".myVideo").muted = true;
            //             gameAudio.play();
            //             $(".button").on('click', function(e){
            //                 if($(".show--3").hasClass("visible")){
            //                     list.addEventListener('click', function(e){
            //                         for(i=0; i<li.length; i++){
            //                             if(e.target.getAttribute("data-num") == "1"){
            //                                 wrongAudio.play();
            //                                 wrongAudio.currentTime = 0;
            //                             }else if(e.target.getAttribute("data-num") == "2"){
            //                                 rightAudio.play();
            //                                 rightAudio.currentTime = 0;
            //                                 if(op4.classList.contains('op--4selected')){
            //                                     setTimeout(() => {
            //                                         gameAudio.remove();
            //                                         gameAudio.pause();
            //                                         vid.play();
            //                                         vid.muted = false;
            //                                         vid.currentTime = 0;
            //                                         $(".myVideo").prop("muted", false);
            //                                     }, 4000);
            //                                 }
            //                             }else if(e.target.getAttribute("data-num") == "3"){
            //                                 wrongAudio.play();
            //                                 wrongAudio.currentTime = 0;
            //                             }else if(e.target.getAttribute("data-num") == "4"){
            //                                 rightAudio.play();
            //                                 rightAudio.currentTime = 0;
            //                                 if(op2.classList.contains('op--2selected')){
            //                                     setTimeout(() => {
            //                                         gameAudio.remove();
            //                                         gameAudio.pause();
            //                                         vid.play();
            //                                         vid.muted = false;
            //                                         vid.currentTime = 0;
            //                                         $(".myVideo").prop("muted", false);
            //                                     }, 4000);
            //                                 }
            //                             }
            //                         }
            //                     })
            //                 }
            //             })
            //         }
            //     }else{
            //         $("video").prop("muted", true);
            //         $(".pause").addClass("active");
            //         $(".play").removeClass("active");
                    
            //         $("audio").prop("muted", true);
            //     }
                
            // })

            
        })
    </script>
    <script>
        const list = document.querySelector('.list');
        const li = document.getElementsByTagName('li');
        const emotion = document.querySelector('.emotion');
        const changeInfo = document.querySelector('.changeInfo');
        const op2 = document.querySelector('.op--2');
        const op4 = document.querySelector('.op--4');
        const link = document.querySelector('.link');
        const bgWrong = document.querySelector('.popup--3').style;
        bgWrong.setProperty('--background', 'url(../img/bg-dark.jpg) center center/cover no-repeat');
        const bgLayer = document.querySelector('.popup').style;
        bgLayer.setProperty('--z-index', '0');
        changeInfo.innerHTML = '<h2>船要開了，趕快將這次要帶的物品搬上船去！<br/>請幫我們選2件物品搬運上船。</h2>'
        const vid = document.querySelector('.myVideo');
        
        function init(){
            emotion.style.background = "url(./img/char-01.png) center center / contain no-repeat"
            // changeInfo.innerHTML = '<h2>船要開了，趕快將這次要帶的物品搬上船去！<br/>請幫我們選2件物品搬運上船。</h2>'
            bgWrong.setProperty('--background', 'url(../img/bg-dark.jpg) center center/cover no-repeat');
            bgLayer.setProperty('--z-index','0');
            $('.show--6').removeClass('v-answer');
            $('.show--7').removeClass('v-answer');
        }
        init();

        
        list.addEventListener('click', function(e){
            
            for(i=0; i<li.length; i++){
                
                if(e.target.getAttribute("data-num") == "1"){
                    emotion.style.background = "url(./img/char-01-false.png) center center / contain no-repeat"
                    // changeInfo.innerHTML = '<h2>噢！這件物品沒看過，不是我們的，<br/>請再想想我們需要的物品。</h2>'
                    $('.show--7').addClass('v-answer');
                    bgLayer.setProperty('--z-index', '-1');
                    setTimeout(() => {
                        init();
                    }, 1000);
                }
                if(e.target.getAttribute("data-num") == "2"){
                    emotion.style.background = "url(./img/char-01-true.png) center center / contain no-repeat"
                    // changeInfo.innerHTML = '<h2>太好了，物品都備齊了。<br/>我們出發吧！</h2>'
                    $('.show--6').addClass('v-answer');
                    $(e.target).addClass("op--2selected");
                    if(op4.classList.contains('op--4selected')){
                        $('.moving').addClass('moving-selected');
                        $('.vanish').addClass('vanish-selected');
                        setTimeout(() => {
                            $('.show--3').removeClass('visible');
                            $('.show--4').addClass('visible');

                            vid.play();
                            vid.currentTime = 0;
                            vid.addEventListener('ended', function(){
                                $('.show--4').removeClass('visible');
                                $('.show--5').addClass('visible');
                                $('.game-audio').remove();
                            });
                        }, 4000);
                    }else{
                        changeInfo.innerHTML = '<h2>做得好！<br/>但我們還差一件物品。</h2>'
                    }
                    setTimeout(() => {
                        init();
                    }, 1000);
                    
                }
                if(e.target.getAttribute("data-num") == "3"){
                    emotion.style.background = "url(./img/char-01-false.png) center center / contain no-repeat"
                    // changeInfo.innerHTML = '<h2>噢！這件物品沒看過，不是我們的，<br/>請再想想我們需要的物品。</h2>'
                    $('.show--7').addClass('v-answer');
                    bgLayer.setProperty('--z-index', '0');
                    setTimeout(() => {
                        init();
                    }, 1000);
                }
                if(e.target.getAttribute("data-num") == "4"){
                    emotion.style.background = "url(./img/char-01-true.png) center center / contain no-repeat"
                    // changeInfo.innerHTML = '<h2>太好了，物品都備齊了。<br/>我們出發吧！</h2>'
                    $('.show--6').addClass('v-answer');
                    $(e.target).addClass("op--4selected");
                    if(op2.classList.contains('op--2selected')){
                        $('.moving').addClass('moving-selected');
                        $('.vanish').addClass('vanish-selected');
                        setTimeout(() => {
                            $('.show--3').removeClass('visible');
                            $('.show--4').addClass('visible');
                            
                            vid.play();
                            vid.currentTime = 0;
                            vid.addEventListener('ended', function(){
                                $('.show--4').removeClass('visible');
                                $('.show--5').addClass('visible');
                                $('.game-audio').remove();
                            });
                        }, 4000);
                    }else{
                        changeInfo.innerHTML = '<h2>做得好！<br/>但我們還差一件物品。</h2>'
                    }
                    
                    setTimeout(() => {
                        init();
                    }, 1000);
                    
                }
            }
        })
    </script>
</body>
</html>